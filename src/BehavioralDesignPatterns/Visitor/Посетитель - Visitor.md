# –ü–æ—Å–µ—Ç–∏—Ç–µ–ª—å - Visitor

–ö–∞—Ç–µ–≥–æ—Ä–∏—è: –ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π

**–ü–æ—Å–µ—Ç–∏—Ç–µ–ª—å**¬†‚Äî —ç—Ç–æ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –≤ –ø—Ä–æ–≥—Ä–∞–º–º—É –Ω–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –Ω–µ –∏–∑–º–µ–Ω—è—è –∫–ª–∞—Å—Å—ã –æ–±—ä–µ–∫—Ç–æ–≤, –Ω–∞–¥ –∫–æ—Ç–æ—Ä—ã–º–∏ —ç—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ –º–æ–≥—É—Ç¬†–≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è.

---

# üõ†Ô∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞

![image.png](%D0%9F%D0%BE%D1%81%D0%B5%D1%82%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20-%20Visitor%209431fa2ced944044a9a9454b732a128b/image.png)

1. **Visitor**¬†–æ–ø–∏—Å—ã–≤–∞–µ—Ç –æ–±—â–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π. –û–Ω –æ–±—ä—è–≤–ª—è–µ—Ç –Ω–∞–±–æ—Ä –º–µ—Ç–æ–¥–æ–≤, –æ—Ç–ª–∏—á–∞—é—â–∏—Ö—Å—è —Ç–∏–ø–æ–º –≤—Ö–æ–¥—è—â–µ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤. –í —è–∑—ã–∫–∞—Ö, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏—Ö –ø–µ—Ä–µ–≥—Ä—É–∑–∫—É –º–µ—Ç–æ–¥–æ–≤, —ç—Ç–∏ –º–µ—Ç–æ–¥—ã –º–æ–≥—É—Ç –∏–º–µ—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∏–º–µ–Ω–∞, –Ω–æ —Ç–∏–ø—ã –∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–æ–ª–∂–Ω—ã –æ—Ç–ª–∏—á–∞—Ç—å—Å—è.
2. **Concrete Visitors**¬†—Ä–µ–∞–ª–∏–∑—É—é—Ç –∫–∞–∫–æ–µ-—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –ø–æ–¥–∞—Ç—å —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è.
3. **Element**¬†–æ–ø–∏—Å—ã–≤–∞–µ—Ç –º–µ—Ç–æ–¥¬†*–ø—Ä–∏–Ω—è—Ç–∏—è*¬†–ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è. –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä, –æ–±—ä—è–≤–ª–µ–Ω–Ω—ã–π —Å —Ç–∏–ø–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è.
4. **Concrete Elements**¬†—Ä–µ–∞–ª–∏–∑—É—é—Ç –º–µ—Ç–æ–¥—ã¬†*–ø—Ä–∏–Ω—è—Ç–∏—è*¬†–ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è. –¶–µ–ª—å —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞¬†‚Äî –≤—ã–∑–≤–∞—Ç—å —Ç–æ—Ç –º–µ—Ç–æ–¥ –ø–æ—Å–µ—â–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç–∏–ø—É —ç—Ç–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞. –¢–∞–∫ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—å —É–∑–Ω–∞–µ—Ç, —Å –∫–∞–∫–∏–º –∏–º–µ–Ω–Ω–æ —ç–ª–µ–º–µ–Ω—Ç–æ–º –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç.
5. **Client**¬†–∑–∞—á–∞—Å—Ç—É—é –≤—ã—Å—Ç—É–ø–∞–µ—Ç –∫–æ–ª–ª–µ–∫—Ü–∏—è –∏–ª–∏ —Å–ª–æ–∂–Ω—ã–π —Å–æ—Å—Ç–∞–≤–Ω–æ–π –æ–±—ä–µ–∫—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–µ—Ä–µ–≤–æ¬†**–ö–æ–º–ø–æ–Ω–æ–≤—â–∏–∫–∞**. –ó–∞—á–∞—Å—Ç—É—é –∫–ª–∏–µ–Ω—Ç –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –∫–ª–∞—Å—Å–∞–º —ç–ª–µ–º–µ–Ω—Ç–æ–≤, —Ä–∞–±–æ—Ç–∞—è —Å –Ω–∏–º–∏ —á–µ—Ä–µ–∑ –æ–±—â–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —ç–ª–µ–º–µ–Ω—Ç–æ–≤.

---

# ‚åó –ü—Å–µ–≤–¥–æ–∫–æ–¥

–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ¬†**–ü–æ—Å–µ—Ç–∏—Ç–µ–ª—å**¬†–¥–æ–±–∞–≤–ª—è–µ—Ç –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∏–µ—Ä–∞—Ä—Ö–∏—é –∫–ª–∞—Å—Å–æ–≤ –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏—Ö —Ñ–∏–≥—É—Ä –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ XML.

![image.png](%D0%9F%D0%BE%D1%81%D0%B5%D1%82%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%20-%20Visitor%209431fa2ced944044a9a9454b732a128b/image%201.png)

```
// –°–ª–æ–∂–Ω–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤.
interface Shape is
	method move(x, y)
	method draw()
	method accept(v: Visitor)

// –ú–µ—Ç–æ–¥ –ø—Ä–∏–Ω—è—Ç–∏—è –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ –∫–∞–∂–¥–æ–º
// —ç–ª–µ–º–µ–Ω—Ç–µ, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –≤ –±–∞–∑–æ–≤–æ–º –∫–ª–∞—Å—Å–µ. –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–µ
// –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–æ–π –º–µ—Ç–æ–¥ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è –Ω—É–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å, –µ—Å–ª–∏ –≤—ã –Ω–µ
// –∑–Ω–∞–µ—Ç–µ —Ç–∏–ø —ç–ª–µ–º–µ–Ω—Ç–∞.
class Dot implements Shape is
	// ...
	method accept(v: Visitor) is
		v.visitDot(this)

class Circle implements Shape is
	// ...
	method accept(v: Visitor) is
		v.visitCircle(this)

class Rectangle implements Shape is
	// ...
	method accept(v: Visitor) is
		v.visitRectangle(this)

class CompoundShape implements Shape is
	// ...
	method accept(v: Visitor) is
		v.visitCompoundShape(this)

// –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–µ—Ç–æ–¥—ã –ø–æ—Å–µ—â–µ–Ω–∏—è
// –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞. –í–∞–∂–Ω–æ, —á—Ç–æ–±—ã –∏–µ—Ä–∞—Ä—Ö–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–µ–Ω—è–ª–∞—Å—å
// —Ä–µ–¥–∫–æ, —Ç–∞–∫ –∫–∞–∫ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø—Ä–∏–¥—ë—Ç—Å—è –º–µ–Ω—è—Ç—å
// –≤—Å–µ—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π.
interface Visitor is
	method visitDot(d: Dot)
	method visitCircle(c: Circle)
	method visitRectangle(r: Rectangle)
	method visitCompoundShape(cs: CompoundShape)

// –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—å —Ä–µ–∞–ª–∏–∑—É–µ—Ç –æ–¥–Ω—É –æ–ø–µ—Ä–∞—Ü–∏—é –¥–ª—è –≤—Å–µ–π
// –∏–µ—Ä–∞—Ä—Ö–∏–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤. –ù–æ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è = –Ω–æ–≤—ã–π –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—å.
// –ü–æ—Å–µ—Ç–∏—Ç–µ–ª—å –≤—ã–≥–æ–¥–Ω–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å, –∫–æ–≥–¥–∞ –Ω–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
// –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –æ—á–µ–Ω—å —Ä–µ–¥–∫–æ, –∞ –Ω–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏¬†‚Äî —á–∞—Å—Ç–æ.
class XMLExportVisitor implements Visitor is
	method visitDot(d: Dot) is
		// –≠–∫—Å–ø–æ—Ä—Ç id –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç —Ü–µ–Ω—Ç—Ä–∞ —Ç–æ—á–∫–∏.

	method visitCircle(c: Circle) is
		// –≠–∫—Å–ø–æ—Ä—Ç id, –∫–æ—Ä–¥–∏–Ω–∞—Ç —Ü–µ–Ω—Ç—Ä–∞ –∏ —Ä–∞–¥–∏—É—Å–∞ –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏.

	method visitRectangle(r: Rectangle) is
		// –≠–∫—Å–ø–æ—Ä—Ç id, –∫–æ—Ä–¥–∏–Ω–∞—Ç –ª–µ–≤–æ–≥–æ-–≤–µ—Ä—Ö–Ω–µ–≥–æ —É–≥–ª–∞, —à–∏—Ä–∏–Ω—ã –∏
    // –≤—ã—Å–æ—Ç—ã –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞.

	method visitCompoundShape(cs: CompoundShape) is
		// –≠–∫—Å–ø–æ—Ä—Ç id —Å–æ—Å—Ç–∞–≤–Ω–æ–π —Ñ–∏–≥—É—Ä—ã, –∞ —Ç–∞–∫–∂–µ —Å–ø–∏—Å–∫–∞ id
    // –ø–æ–¥—Ñ–∏–≥—É—Ä, –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –æ–Ω–∞ —Å–æ—Å—Ç–æ–∏—Ç.

// –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è –∫ –ª—é–±–æ–º—É –Ω–∞–±–æ—Ä—É
// –æ–±—ä–µ–∫—Ç–æ–≤ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –¥–∞–∂–µ –Ω–µ —É—Ç–æ—á–Ω—è—è –∏—Ö —Ç–∏–ø—ã. –ù—É–∂–Ω—ã–π –º–µ—Ç–æ–¥
// –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è –±—É–¥–µ—Ç –≤—ã–±—Ä–∞–Ω –±–ª–∞–≥–æ–¥–∞—Ä—è –ø—Ä–æ—Ö–æ–¥—É —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥ accept.
class Application is
	field allShapes: array of Shapes

	method export() is
		exportVisitor = new XMLExportVisitor()

		foreach (shape in allShapes) do
	    shape.accept(exportVisitor)
```