# –û–¥–∏–Ω–æ—á–∫–∞ - Singleton

–ö–∞—Ç–µ–≥–æ—Ä–∏—è: –ü–æ—Ä–æ–∂–¥–∞—é—â–∏–π

**–û–¥–∏–Ω–æ—á–∫–∞**¬†‚Äî —ç—Ç–æ –ø–æ—Ä–æ–∂–¥–∞—é—â–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —É –∫–ª–∞—Å—Å–∞ –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä, –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫ –Ω–µ–º—É –≥–ª–æ–±–∞–ª—å–Ω—É—é —Ç–æ—á–∫—É¬†–¥–æ—Å—Ç—É–ø–∞.

---

# üõ†Ô∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞

![image.png](image.png)

1. **Singleton** –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥ `getInstance`, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä —Å–≤–æ–µ–≥–æ –∫–ª–∞—Å—Å–∞

–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –æ–¥–∏–Ω–æ—á–∫–∏ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–∫—Ä—ã—Ç –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤. –í—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞ `getInstance` –¥–æ–ª–∂–µ–Ω —Å—Ç–∞—Ç—å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º –ø–æ–ª—É—á–∏—Ç—å –æ–±—ä–µ–∫—Ç —ç—Ç–æ–≥–æ –∫–ª–∞—Å—Å–∞.

---

# ‚åó –ü—Å–µ–≤–¥–æ–∫–æ–¥

–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ —Ä–æ–ª—å¬†**–û–¥–∏–Ω–æ—á–∫–∏**¬†–æ—Ç—ã–≥—Ä—ã–≤–∞–µ—Ç –∫–ª–∞—Å—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

–≠—Ç–æ—Ç –∫–ª–∞—Å—Å –Ω–µ –∏–º–µ–µ—Ç –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞, –ø–æ—ç—Ç–æ–º—É –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± –ø–æ–ª—É—á–∏—Ç—å –µ–≥–æ –æ–±—ä–µ–∫—Ç¬†‚Äî —ç—Ç–æ –≤—ã–∑–≤–∞—Ç—å –º–µ—Ç–æ–¥¬†`getInstance`. –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ —Å–æ—Ö—Ä–∞–Ω–∏—Ç –ø–µ—Ä–≤—ã–π —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç –∏ –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –µ–≥–æ –ø—Ä–∏ –≤—Å–µ—Ö –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –≤—ã–∑–æ–≤–∞—Ö.

```
// –ö–ª–∞—Å—Å –æ–¥–∏–Ω–æ—á–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥ `getInstance`,
// –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞–º –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ
// –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ –≤—Å–µ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ.
class Database is
	// –ü–æ–ª–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞-–æ–¥–∏–Ω–æ—á–∫–∏ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–æ
  // —Å—Ç–∞—Ç–∏—á–Ω—ã–º.
	private static field instance: Database

  // –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –æ–¥–∏–Ω–æ—á–∫–∏ –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–µ–Ω –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –ø—Ä–∏–≤–∞—Ç–Ω—ã–º,
  // —á—Ç–æ–±—ã –∫–ª–∏–µ–Ω—Ç—ã –Ω–µ –º–æ–≥–ª–∏ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å
  // —ç–∫–∑–µ–º–ø–ª—è—Ä—ã —ç—Ç–æ–≥–æ –∫–ª–∞—Å—Å–∞ —á–µ—Ä–µ–∑ –æ–ø–µ—Ä–∞—Ç–æ—Ä `new`.
	private constructor Database() is
		// –ó–¥–µ—Å—å –º–æ–∂–µ—Ç –∂–∏—Ç—å –∫–æ–¥ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫
    // —Å–µ—Ä–≤–µ—Ä—É –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö.
    // ...

  // –û—Å–Ω–æ–≤–Ω–æ–π —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥ –æ–¥–∏–Ω–æ—á–∫–∏ —Å–ª—É–∂–∏—Ç –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–æ–π
  // –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—É –∏ —è–≤–ª—è–µ—Ç—Å—è —Ç–æ—á–∫–æ–π –¥–æ—Å—Ç—É–ø–∞ –∫ —ç–∫–∑–µ–º–ø–ª—è—Ä—É —ç—Ç–æ–≥–æ
  // –∫–ª–∞—Å—Å–∞.
	public static method getInstance() is
		if (Database.instance ==null) then
			acquireThreadLock() and then
			// –ù–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π –µ—â—ë —Ä–∞–∑ –ø—Ä–æ–≤–µ—Ä–∏–º, –Ω–µ –±—ã–ª –ª–∏
      // –æ–±—ä–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –¥—Ä—É–≥–∏–º –ø–æ—Ç–æ–∫–æ–º, –ø–æ–∫–∞ —Ç–µ–∫—É—â–∏–π
      // –∂–¥–∞–ª –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.
			if (Database.instance ==null) then
				Database.instance = new Database()
		return Database.instance

  // –ù–∞–∫–æ–Ω–µ—Ü, –ª—é–±–æ–π –∫–ª–∞—Å—Å –æ–¥–∏–Ω–æ—á–∫–∏ –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –∫–∞–∫—É—é-—Ç–æ
  // –ø–æ–ª–µ–∑–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å, –∫–æ—Ç–æ—Ä—É—é –∫–ª–∏–µ–Ω—Ç—ã –±—É–¥—É—Ç
  // –∑–∞–ø—É—Å–∫–∞—Ç—å —á–µ—Ä–µ–∑ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç –æ–¥–∏–Ω–æ—á–∫–∏.
	public method query(sql) is
		// –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –±—É–¥—É—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ —ç—Ç–æ—Ç
    // –º–µ—Ç–æ–¥. –ü–æ—ç—Ç–æ–º—É –∏–º–µ–µ—Ç —Å–º—ã—Å–ª –ø–æ–º–µ—Å—Ç–∏—Ç—å —Å—é–¥–∞ –∫–∞–∫—É—é-—Ç–æ
    // –ª–æ–≥–∏–∫—É –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è.
    // ...

class Application is 
	method main() is
		Database foo = Database.getInstance()
    foo.query("SELECT ...")
    // ...
    Database bar = Database.getInstance()
    bar.query("SELECT ...")
    // –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è "bar" —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ—Ç –∂–µ –æ–±—ä–µ–∫—Ç, —á—Ç–æ –∏
    // –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è "foo".
```